use dep::std;
use dep::ecrecover;

fn main(
    owner_hash: pub Field,
    // domain_separator: pub [u8;32],
    hashed_message: pub [u8; 32],
    pub_key: [u8; 64], 
    signature: [u8; 64], 
) {
    let key = ecrecover::secp256k1::PubKey::from_unified(pub_key);

    let recovered_addr = ecrecover::ecrecover(
        key.pub_x, 
        key.pub_y,
        signature,
        hashed_message
    );

    // std::println(recovered_addr);

    // let mut input: [Field; 33] = [0; 33];
    // input[0] = recovered_addr;
    // for i in 0..32 {
    //     input[i + 1] = domain_separator[i] as Field;
    // }

    // let computed_hash = std::hash::pedersen_hash(input);
    let computed_hash = std::hash::pedersen_hash([recovered_addr]);
    // std::println(computed_hash);
    // std::println(owner_hash);

    assert(computed_hash == owner_hash);
}

#[test]
fn test_main() {

  let hashed_message = [
  162,  11, 221, 82, 101,  38, 145, 153,
  143, 140, 164, 97, 148, 164,  55, 133,
   17,  93, 198, 63, 125, 169, 147,  53,
  229, 221,  91, 27,   2, 153, 104, 166
  ];

  // slice(1, 65)
  let pub_key = [
   30, 208, 241, 215, 103,  94, 254, 117,  70, 152,
   81, 205,  82, 148,   1, 169, 164,  67,  60,   5,  20,
  174, 250, 221, 242,  79,   1,  65, 210,  85, 102, 168,
  120, 138,  73, 199,  27, 230, 199, 139,  88,  30, 223,
  222, 101,  80, 215, 183, 206, 127,  56, 111,  54,  82,
   44, 173,  86,  64, 143, 202,   3, 123,  35,   7
  ];

  let owner_hash = 0x137ad2247d8e089ca5dc03f9a70e5bc68392ac2916495968a80c35582c1a3c37;
//  let owner_hash = 0x0ee869caf0f6187c861a3a319899bb97d0477722d2bce78c99012dc1ae6d729e;
//   let domain_separator: [u8;32] = [
//     104, 180, 171,  96, 220, 243, 144,  50,
//     0, 243, 196,  36, 122, 173, 193, 146,
//     6, 179,  23,  80, 130, 243,  86, 120,
//     244, 174, 100, 147, 213,  51, 243, 148
//   ]; 

    
  let signature = [
   25,  83, 188,  15,  31, 138, 125,  61,  75, 210,  21,
  189, 152,   0,  92, 131, 218, 172,  94, 192, 193, 134,
  157, 109, 196, 152, 210, 247, 229, 218,  78, 217,  93,
  135, 208,  54, 203, 151, 127,  76, 197, 189,  92,   5,
  141, 185,  59, 102, 220, 138, 219, 235,  91, 108, 193,
  227,  61, 200,  57, 163, 137,  92,  36, 209
  ];

//   main(owner_hash, domain_separator,hashed_message, pub_key, signature);
 main(owner_hash,hashed_message, pub_key, signature);
}


// #[test]
// fn test_main2() {
    
// let owner_hash = 0x04aa9bc66094f8ee4a59cef0b0b99cb9297da9d28f1c1414b7f5a3eeb1720366let
// domain_separator = [0x00000000000000000000000000000000000000000000000000000000000000bc, 0x00000000000000000000000000000000000000000000000000000000000000b8, 0x0000000000000000000000000000000000000000000000000000000000000064, 0x00000000000000000000000000000000000000000000000000000000000000b0, 0x00000000000000000000000000000000000000000000000000000000000000ee, 0x0000000000000000000000000000000000000000000000000000000000000024, 0x00000000000000000000000000000000000000000000000000000000000000f7, 0x00000000000000000000000000000000000000000000000000000000000000f5, 0x00000000000000000000000000000000000000000000000000000000000000fc, 0x0000000000000000000000000000000000000000000000000000000000000072, 0x00000000000000000000000000000000000000000000000000000000000000ce, 0x00000000000000000000000000000000000000000000000000000000000000cf, 0x00000000000000000000000000000000000000000000000000000000000000f9, 0x00000000000000000000000000000000000000000000000000000000000000ac, 0x000000000000000000000000000000000000000000000000000000000000007f, 0x000000000000000000000000000000000000000000000000000000000000009e, 0x00000000000000000000000000000000000000000000000000000000000000a5, 0x00000000000000000000000000000000000000000000000000000000000000b2, 0x00000000000000000000000000000000000000000000000000000000000000fd, 0x0000000000000000000000000000000000000000000000000000000000000058, 0x00000000000000000000000000000000000000000000000000000000000000b3, 0x000000000000000000000000000000000000000000000000000000000000003c, 0x0000000000000000000000000000000000000000000000000000000000000050, 0x0000000000000000000000000000000000000000000000000000000000000032, 0x00000000000000000000000000000000000000000000000000000000000000b5, 0x000000000000000000000000000000000000000000000000000000000000003a, 0x000000000000000000000000000000000000000000000000000000000000009c, 0x0000000000000000000000000000000000000000000000000000000000000017, 0x00000000000000000000000000000000000000000000000000000000000000b4, 0x00000000000000000000000000000000000000000000000000000000000000ed, 0x000000000000000000000000000000000000000000000000000000000000001f, 0x0000000000000000000000000000000000000000000000000000000000000091]
// hashed_message = [0x0000000000000000000000000000000000000000000000000000000000000091, 0x00000000000000000000000000000000000000000000000000000000000000ab, 0x0000000000000000000000000000000000000000000000000000000000000097, 0x00000000000000000000000000000000000000000000000000000000000000ad, 0x000000000000000000000000000000000000000000000000000000000000002c, 0x0000000000000000000000000000000000000000000000000000000000000009, 0x0000000000000000000000000000000000000000000000000000000000000031, 0x00000000000000000000000000000000000000000000000000000000000000d0, 0x00000000000000000000000000000000000000000000000000000000000000f7, 0x00000000000000000000000000000000000000000000000000000000000000ca, 0x0000000000000000000000000000000000000000000000000000000000000011, 0x00000000000000000000000000000000000000000000000000000000000000bf, 0x000000000000000000000000000000000000000000000000000000000000003d, 0x00000000000000000000000000000000000000000000000000000000000000f9, 0x0000000000000000000000000000000000000000000000000000000000000033, 0x0000000000000000000000000000000000000000000000000000000000000074, 0x0000000000000000000000000000000000000000000000000000000000000003, 0x0000000000000000000000000000000000000000000000000000000000000042, 0x0000000000000000000000000000000000000000000000000000000000000013, 0x0000000000000000000000000000000000000000000000000000000000000057, 0x0000000000000000000000000000000000000000000000000000000000000037, 0x0000000000000000000000000000000000000000000000000000000000000046, 0x0000000000000000000000000000000000000000000000000000000000000089, 0x0000000000000000000000000000000000000000000000000000000000000035, 0x00000000000000000000000000000000000000000000000000000000000000c7, 0x000000000000000000000000000000000000000000000000000000000000005c, 0x00000000000000000000000000000000000000000000000000000000000000c6, 0x00000000000000000000000000000000000000000000000000000000000000fc, 0x000000000000000000000000000000000000000000000000000000000000004d, 0x00000000000000000000000000000000000000000000000000000000000000cd, 0x000000000000000000000000000000000000000000000000000000000000007c, 0x00000000000000000000000000000000000000000000000000000000000000a6]
// pub_key = [0x000000000000000000000000000000000000000000000000000000000000001e, 0x00000000000000000000000000000000000000000000000000000000000000d0, 0x00000000000000000000000000000000000000000000000000000000000000f1, 0x00000000000000000000000000000000000000000000000000000000000000d7, 0x0000000000000000000000000000000000000000000000000000000000000067, 0x000000000000000000000000000000000000000000000000000000000000005e, 0x00000000000000000000000000000000000000000000000000000000000000fe, 0x0000000000000000000000000000000000000000000000000000000000000075, 0x0000000000000000000000000000000000000000000000000000000000000046, 0x0000000000000000000000000000000000000000000000000000000000000098, 0x0000000000000000000000000000000000000000000000000000000000000051, 0x00000000000000000000000000000000000000000000000000000000000000cd, 0x0000000000000000000000000000000000000000000000000000000000000052, 0x0000000000000000000000000000000000000000000000000000000000000094, 0x0000000000000000000000000000000000000000000000000000000000000001, 0x00000000000000000000000000000000000000000000000000000000000000a9, 0x00000000000000000000000000000000000000000000000000000000000000a4, 0x0000000000000000000000000000000000000000000000000000000000000043, 0x000000000000000000000000000000000000000000000000000000000000003c, 0x0000000000000000000000000000000000000000000000000000000000000005, 0x0000000000000000000000000000000000000000000000000000000000000014, 0x00000000000000000000000000000000000000000000000000000000000000ae, 0x00000000000000000000000000000000000000000000000000000000000000fa, 0x00000000000000000000000000000000000000000000000000000000000000dd, 0x00000000000000000000000000000000000000000000000000000000000000f2, 0x000000000000000000000000000000000000000000000000000000000000004f, 0x0000000000000000000000000000000000000000000000000000000000000001, 0x0000000000000000000000000000000000000000000000000000000000000041, 0x00000000000000000000000000000000000000000000000000000000000000d2, 0x0000000000000000000000000000000000000000000000000000000000000055, 0x0000000000000000000000000000000000000000000000000000000000000066, 0x00000000000000000000000000000000000000000000000000000000000000a8, 0x0000000000000000000000000000000000000000000000000000000000000078, 0x000000000000000000000000000000000000000000000000000000000000008a, 0x0000000000000000000000000000000000000000000000000000000000000049, 0x00000000000000000000000000000000000000000000000000000000000000c7, 0x000000000000000000000000000000000000000000000000000000000000001b, 0x00000000000000000000000000000000000000000000000000000000000000e6, 0x00000000000000000000000000000000000000000000000000000000000000c7, 0x000000000000000000000000000000000000000000000000000000000000008b, 0x0000000000000000000000000000000000000000000000000000000000000058, 0x000000000000000000000000000000000000000000000000000000000000001e, 0x00000000000000000000000000000000000000000000000000000000000000df, 0x00000000000000000000000000000000000000000000000000000000000000de, 0x0000000000000000000000000000000000000000000000000000000000000065, 0x0000000000000000000000000000000000000000000000000000000000000050, 0x00000000000000000000000000000000000000000000000000000000000000d7, 0x00000000000000000000000000000000000000000000000000000000000000b7, 0x00000000000000000000000000000000000000000000000000000000000000ce, 0x000000000000000000000000000000000000000000000000000000000000007f, 0x0000000000000000000000000000000000000000000000000000000000000038, 0x000000000000000000000000000000000000000000000000000000000000006f, 0x0000000000000000000000000000000000000000000000000000000000000036, 0x0000000000000000000000000000000000000000000000000000000000000052, 0x000000000000000000000000000000000000000000000000000000000000002c, 0x00000000000000000000000000000000000000000000000000000000000000ad, 0x0000000000000000000000000000000000000000000000000000000000000056, 0x0000000000000000000000000000000000000000000000000000000000000040, 0x000000000000000000000000000000000000000000000000000000000000008f, 0x00000000000000000000000000000000000000000000000000000000000000ca, 0x0000000000000000000000000000000000000000000000000000000000000003, 0x000000000000000000000000000000000000000000000000000000000000007b, 0x0000000000000000000000000000000000000000000000000000000000000023, 0x0000000000000000000000000000000000000000000000000000000000000007]
// signature = [0x00000000000000000000000000000000000000000000000000000000000000f0, 0x00000000000000000000000000000000000000000000000000000000000000f1, 0x0000000000000000000000000000000000000000000000000000000000000040, 0x0000000000000000000000000000000000000000000000000000000000000075, 0x000000000000000000000000000000000000000000000000000000000000005c, 0x00000000000000000000000000000000000000000000000000000000000000db, 0x000000000000000000000000000000000000000000000000000000000000009a, 0x0000000000000000000000000000000000000000000000000000000000000075, 0x00000000000000000000000000000000000000000000000000000000000000d1, 0x0000000000000000000000000000000000000000000000000000000000000096, 0x0000000000000000000000000000000000000000000000000000000000000037, 0x00000000000000000000000000000000000000000000000000000000000000e1, 0x00000000000000000000000000000000000000000000000000000000000000f5, 0x000000000000000000000000000000000000000000000000000000000000007e, 0x0000000000000000000000000000000000000000000000000000000000000040, 0x0000000000000000000000000000000000000000000000000000000000000015, 0x000000000000000000000000000000000000000000000000000000000000003e, 0x000000000000000000000000000000000000000000000000000000000000000c, 0x000000000000000000000000000000000000000000000000000000000000005b, 0x000000000000000000000000000000000000000000000000000000000000009c, 0x0000000000000000000000000000000000000000000000000000000000000050, 0x00000000000000000000000000000000000000000000000000000000000000fb, 0x0000000000000000000000000000000000000000000000000000000000000059, 0x00000000000000000000000000000000000000000000000000000000000000b4, 0x00000000000000000000000000000000000000000000000000000000000000e9, 0x0000000000000000000000000000000000000000000000000000000000000035, 0x00000000000000000000000000000000000000000000000000000000000000a3, 0x000000000000000000000000000000000000000000000000000000000000003a, 0x0000000000000000000000000000000000000000000000000000000000000034, 0x000000000000000000000000000000000000000000000000000000000000004e, 0x00000000000000000000000000000000000000000000000000000000000000a0, 0x0000000000000000000000000000000000000000000000000000000000000006, 0x000000000000000000000000000000000000000000000000000000000000003b, 0x0000000000000000000000000000000000000000000000000000000000000086, 0x000000000000000000000000000000000000000000000000000000000000009e, 0x000000000000000000000000000000000000000000000000000000000000000b, 0x000000000000000000000000000000000000000000000000000000000000008f, 0x000000000000000000000000000000000000000000000000000000000000005f, 0x000000000000000000000000000000000000000000000000000000000000005b, 0x00000000000000000000000000000000000000000000000000000000000000b6, 0x000000000000000000000000000000000000000000000000000000000000008c, 0x000000000000000000000000000000000000000000000000000000000000006e, 0x00000000000000000000000000000000000000000000000000000000000000f0, 0x0000000000000000000000000000000000000000000000000000000000000038, 0x00000000000000000000000000000000000000000000000000000000000000d9, 0x000000000000000000000000000000000000000000000000000000000000003d, 0x0000000000000000000000000000000000000000000000000000000000000085, 0x000000000000000000000000000000000000000000000000000000000000005b, 0x000000000000000000000000000000000000000000000000000000000000001b, 0x00000000000000000000000000000000000000000000000000000000000000ef, 0x000000000000000000000000000000000000000000000000000000000000009d, 0x0000000000000000000000000000000000000000000000000000000000000095, 0x0000000000000000000000000000000000000000000000000000000000000029, 0x00000000000000000000000000000000000000000000000000000000000000c2, 0x0000000000000000000000000000000000000000000000000000000000000044, 0x000000000000000000000000000000000000000000000000000000000000000a, 0x00000000000000000000000000000000000000000000000000000000000000ef, 0x00000000000000000000000000000000000000000000000000000000000000d5, 0x00000000000000000000000000000000000000000000000000000000000000ca, 0x000000000000000000000000000000000000000000000000000000000000000c, 0x000000000000000000000000000000000000000000000000000000000000009f, 0x00000000000000000000000000000000000000000000000000000000000000ff, 0x000000000000000000000000000000000000000000000000000000000000002e, 0x000000000000000000000000000000000000000000000000000000000000002f]
// }